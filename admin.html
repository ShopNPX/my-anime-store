<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>NPX Admin | Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <style>
        body { font-family: sans-serif; background: #f0f2f5; padding: 20px; }
        .order-card { background: white; padding: 20px; border-radius: 10px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .btn { padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; color: white; font-weight: bold; margin-left: 5px; }
        .btn-ship { background: #007bff; }
        .btn-deliver { background: #28a745; }
        .btn-del { background: #dc3545; }
        .status { font-weight: bold; color: #555; }
    </style>
</head>
<body>
    <h1>Ù…Ø¯ÙŠØ± NPX STORE ğŸ‘‘</h1>
    <div id="admin-orders">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª...</div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAVadEAFdmh0SuWq4sZJkSJJrRpF5fOp58",
            authDomain: "authen-36a1f.firebaseapp.com",
            projectId: "authen-36a1f",
            databaseURL: "https://authen-36a1f-default-rtdb.firebaseio.com/",
            appId: "1:144619996396:web:21c057f485099f574bd1c9"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        db.ref('orders').on('value', snap => {
            const orders = snap.val();
            const container = document.getElementById('admin-orders');
            if(!orders) { container.innerHTML = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹."; return; }
            
            container.innerHTML = Object.keys(orders).map(id => {
                const o = orders[id];
                return `
                <div class="order-card">
                    <h3>Ø§Ù„Ø¹Ù…ÙŠÙ„: ${id}</h3>
                    <p>Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª: ${o.items.join(' - ')}</p>
                    <p>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <b>$${o.total}</b></p>
                    <p class="status">Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ${o.status}</p>
                    <button class="btn btn-ship" onclick="updateStatus('${id}', 'shipping')">Ø´Ø­Ù† ğŸšš</button>
                    <button class="btn btn-deliver" onclick="updateStatus('${id}', 'delivered')">ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ… âœ…</button>
                    <button class="btn btn-del" onclick="deleteOrder('${id}')">Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ ğŸ—‘ï¸</button>
                </div>`;
            }).join('');
        });

        function updateStatus(uid, newStatus) {
            db.ref('orders/' + uid).update({ status: newStatus });
        }

        function deleteOrder(uid) {
            if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ")) db.ref('orders/' + uid).remove();
        }
    </script>
</body>
</html>
